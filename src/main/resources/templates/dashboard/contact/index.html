<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{dashboard/layout}">
<head>
  <meta charset="UTF-8">
  <title>Contact Messages</title>
  <style>
    .contact-container { padding: 20px; background: #f8f9fa; min-height: 100vh; }
    .page-header { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; border-left: 4px solid #e67e22; }
    .page-title { margin: 0; color: #2c3e50; font-size: 24px; font-weight: 600; }
    .messages-grid { display: grid; gap: 15px; }
    .message-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease; border-left: 4px solid transparent; position: relative; }
    .message-card:hover { transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    .message-card.unread { background: #fff3cd; border-left-color: #f39c12; }
    .message-card.read { background: #f8f9fa; border-left-color: #6c757d; }
    .message-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .sender-info { flex-grow: 1; }
    .sender-name { font-weight: 600; color: #2c3e50; font-size: 16px; margin-bottom: 4px; }
    .sender-email { color: #7f8c8d; font-size: 14px; }
    .message-status { display: flex; align-items: center; gap: 8px; }
    .status-badge { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 500; }
    .status-unread { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
    .status-read { background: #e2e3e5; color: #6c757d; border: 1px solid #d6d8db; }
    .message-preview { color: #34495e; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .message-link { display: block; text-decoration: none; color: inherit; cursor: pointer; }
    .message-link:hover { text-decoration: none; color: inherit; }
    .no-messages { text-align: center; padding: 60px 20px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .no-messages-icon { font-size: 48px; color: #bdc3c7; margin-bottom: 20px; }
    .no-messages-text { color: #7f8c8d; font-size: 16px; }
    @media (max-width: 768px) { .contact-container { padding: 10px; } .message-card { padding: 15px; } }
  </style>
</head>
<body>
<div layout:fragment="content">
  <div class="contact-container">
    <div class="page-header">
      <h1 class="page-title">Contact Messages</h1>
    </div>

    <div th:if="${messages != null and !messages.empty}">
      <div class="messages-grid">
        <div th:each="message : ${messages}"
             class="message-card"
             th:classappend="${message.read} ? 'read' : 'unread'">

          <!-- Gizli POST form (yalnÄ±z "Read" statusunu dÉ™yiÅŸmÉ™k Ã¼Ã§Ã¼n) -->
          <form th:action="@{/dashboard/contact/read-message/{id}(id=${message.id})}"
                method="post"
                th:id="'readForm-' + ${message.id}"
                style="display: none;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          </form>

          <!-- Mesaja keÃ§id linki -->
          <a th:href="@{/dashboard/contact/message/{id}(id=${message.id})}"
             class="message-link"
             th:onclick="'event.preventDefault(); document.getElementById(\'readForm-' + ${message.id} + '\').submit();'">

            <div class="message-header">
              <div class="sender-info">
                <div class="sender-name" th:text="${message.fullName}">John Doe</div>
                <div class="sender-email" th:text="${message.email}">john@example.com</div>
              </div>
              <div class="message-status">
                <span class="status-badge"
                      th:classappend="${message.read} ? 'status-read' : 'status-unread'"
                      th:text="${message.read} ? 'Read' : 'New'">New</span>
              </div>
            </div>

            <div class="message-preview" th:text="${message.message}">
              This is a preview of the message content...
            </div>
          </a>
        </div>
      </div>
    </div>

    <div th:if="${messages == null or messages.empty}" class="no-messages">
      <div class="no-messages-icon">ðŸ“§</div>
      <div class="no-messages-text">No contact messages yet.</div>
    </div>
  </div>
</div>
</body>
</html>