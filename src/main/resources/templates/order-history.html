<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
        lang="en"
        layout:decorate="~{layout}">
<head>
  <meta charset="utf-8">
  <title>Order History</title>
</head>
<body>

<div layout:fragment="content">

  <h2>Order History</h2>

  <div th:each="order : ${orders}" class="order-section" style="margin-bottom: 40px;">
    <h4>Order #<span th:text="${order.id}">1</span> -
      <span th:text="${#dates.format(order.orderDate, 'yyyy-MM-dd')}">2025-09-17</span>
    </h4>

    <table class="table table-bordered table-striped">
      <thead>
      <tr>
        <th>Photo</th>
        <th>Product Name</th>
        <th>Product Code</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Total Amount</th>
        <th>Size</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="op : ${order.orderProducts}">
        <td><img th:src="@{${op.product.photoUrl}}" alt="Product Photo" style="width:50px;height:50px;object-fit:cover;"></td>
        <td th:text="${op.product.name}">Product Name</td>
        <td th:text="${op.product.productCode}">Product Code</td>
        <td th:text="${'$' + #numbers.formatDecimal(
                            op.product.discountPrice > 0 ?
                            op.price * (1 - op.product.discountPrice) :
                            op.price, 1, 2)}"
            th:class="${op.product.discountPrice > 0} ? 'text-danger font-weight-bold' : 'font-weight-bold'">
          Price
        </td>
        <td th:text="${op.quantity}">1</td>
        <td th:text="${'$' + #numbers.formatDecimal(
                            (op.product.discountPrice > 0 ?
                            op.price * (1 - op.product.discountPrice) :
                            op.price) * op.quantity, 1, 2)}">
          Total
        </td>
        <td th:text="${op.size}">M</td>
      </tr>
      </tbody>
    </table>

    <p><strong>Comment:</strong> <span th:text="${order.comment}">No comment</span></p>
    <hr/>
  </div>

</div>

</body>
</html>
